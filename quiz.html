<div class="quiz">
    <h1 style="text-align:center; margin:10px;">Test Yourself</h1>
    <?php
              // Check the quiz answers and show the results
              $quiz=array();
              if($_SERVER["REQUEST_METHOD"]=="GET"){
                $sql="SELECT * FROM `quiz`;";
                $result=mysqli_query($conn,$sql);
                $ques=array();
                $left=5;
                while($row=mysqli_fetch_assoc($result)){
                    $ques[]=array($row['ques'],$row['op1'],$row['op2'],$row['op3'],$row['op4'],$row['cr_op']);
                }
                shuffle($ques);
                for($i=0;$i<count($ques);$i++){
                    if(count($ques)-$i>$left){
                        $random_number = rand(0, 1);
                        if($random_number%2){
                            $left--;
                            $quiz[]=$ques[$i];
                        }
                    }
                    else{
                        $left--;
                        $quiz[]=$ques[$i];
                    }
                }
                $_SESSION['quiz']=$quiz;
              }
              else{
                $quiz=$_SESSION['quiz'];
              }
              if (isset($_POST['submit'])) {

                  $correct = 0;
                  for ($i=0; $i<5; $i++) {
                      if (isset($_POST['q'.$i]) && $_POST['q'.$i] == $quiz[$i][5]) {
                      $correct++;
                      }
                  }
                  echo "<h4>You got ".$correct." out of 5 questions correct!</h4>";
                  for ($i=0; $i<5; $i++) {
                      if (isset($_POST['q'.$i]) && $_POST['q'.$i] == $quiz[$i][5]) {
                      echo "<p>Question ".($i+1).": ".$quiz[$i][0]." <span style='color:green'>Correct</span></p>";
                      } else {
                      echo "<p>Question ".($i+1).": ".$quiz[$i][0]." <span style='color:red'>Incorrect</span> Correct answer is :".$quiz[$i][$quiz[$i][5]]."</p>";
                      }
                  }
              }
              // Define the quiz questions and answers as an array of arrays

              // Generate the quiz form

              echo "<form method='post'>";
              for ($i=0; $i<5; $i++) {
              echo "<h3>".$quiz[$i][0]."</h3>";
              for ($j=1; $j<5; $j++) {
                  echo "<label><input type='radio' name='q".$i."' value='".$j."'>".$quiz[$i][$j]."</label><br>";
              }
              }

              echo "<input type='submit' name='submit' class='btn' value='Submit'>";
              echo "</form>";

          ?>
    <form post="get" action="<?php echo htmlspecialchars($_SERVER['PHP_SELF']);?>"> <button type="submit"
            class="btn">Retake test</button></form>
</div>